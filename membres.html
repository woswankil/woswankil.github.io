<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Test récupération CSV</title>
</head>
<body>
  <h1>Test récupération CSV - Regarde la console</h1>
  <script>
    const sheetCSVUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRKpE1Pur7Wd-PbfQMBwqYAlvEz3-Ofr82W1mCYulzq3mSQFEddikwmfguHQlfnIpVLZmu_su9krRbV/pub?gid=0&single=true&output=csv';

    function csvToArray(str, delimiter = ',') {
      const lines = str.trim().split('\n');
      const headers = lines.shift().split(delimiter).map(h => h.trim());
      return lines.map(line => {
        const values = line.split(delimiter);
        const obj = {};
        headers.forEach((header, i) => {
          obj[header] = values[i] ? values[i].trim() : '';
        });
        return obj;
      });
    }

    async function testFetch() {
      try {
        const response = await fetch(sheetCSVUrl);
        if (!response.ok) throw new Error('Erreur chargement CSV');
        const csvText = await response.text();
        const players = csvToArray(csvText);

        players.forEach(p => {
          console.log(`ID: ${p['A']}, Pseudo (B): ${p['B']}, Avatar (M): ${p['M']}`);
        });
      } catch (e) {
        console.error(e);
      }
    }

    testFetch();
  </script>
</body>
</html>
